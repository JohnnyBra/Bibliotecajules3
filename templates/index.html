{% extends 'base.html' %}

{% block content %}
<div class="row mb-5 hero-section rounded-3 shadow-sm">
    <div class="col-md-7 d-flex align-items-center">
        <div class="p-4">
            <h1 class="display-4 fw-bold text-primary mb-3">Â¡Bienvenido a tu Biblioteca! ğŸ°</h1>
            <p class="fs-4 text-muted mb-4">Descubre historias increÃ­bles, aprende cosas nuevas y gana puntos mÃ¡gicos.</p>
            <div class="d-grid gap-2 d-sm-flex">
                <a href="{{ url_for('catalog') }}" class="btn btn-primary btn-lg px-4 gap-3">Explorar Libros ğŸ—ºï¸</a>
                {% if not current_user.is_authenticated %}
                <a href="{{ url_for('register') }}" class="btn btn-outline-secondary btn-lg px-4">Crear mi cuenta âœ¨</a>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="col-md-5">
        {% if book_of_month %}
        <div class="card h-100 border-0 shadow-lg floating-element" style="background: linear-gradient(135deg, #FF6961 0%, #FFB347 100%); color: white;">
            <div class="card-header border-0 fs-5">ğŸŒŸ Libro del Mes ğŸŒŸ</div>
            <div class="card-body text-center">
                <div class="bg-white text-dark rounded-3 p-3 mb-3 shadow-sm">
                    <h3 class="card-title fw-bold">{{ book_of_month.title }}</h3>
                    <p class="card-text text-muted">de {{ book_of_month.author }}</p>
                </div>
                <p class="fs-5">Â¡Puntos extra si lo lees!</p>
                {% if book_of_month.available_copies > 0 %}
                <a href="{{ url_for('borrow_book', book_id=book_of_month.id) }}" class="btn btn-light fw-bold w-100 rounded-pill text-primary">Â¡Lo quiero leer! ğŸ“–</a>
                {% else %}
                <button class="btn btn-light fw-bold w-100 rounded-pill text-muted" disabled>Â¡Agotado! ğŸ˜±</button>
                {% endif %}
            </div>
        </div>
        {% else %}
        <div class="card h-100 bg-secondary text-white border-0 shadow">
            <div class="card-body d-flex align-items-center justify-content-center">
                <h5>ğŸš§ PrÃ³ximamente: Libro del Mes ğŸš§</h5>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<div class="row g-4">
    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-header text-primary">ğŸ† SalÃ³n de la Fama</div>
            <div class="card-body">
                <ul class="list-group list-group-flush leaderboard-list">
                    {% for user in top_readers %}
                    <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                        <span class="fw-bold">
                            {% if loop.index == 1 %}ğŸ¥‡{% elif loop.index == 2 %}ğŸ¥ˆ{% elif loop.index == 3 %}ğŸ¥‰{% else %}âœ¨{% endif %}
                            {{ user.username }} <small class="text-muted fw-normal">({{ user.student_class }})</small>
                        </span>
                        <span class="badge bg-warning text-dark rounded-pill fs-6">{{ user.points }} pts</span>
                    </li>
                    {% endfor %}
                    {% if not top_readers %}
                    <p class="text-center text-muted">Â¡SÃ© el primero en aparecer aquÃ­!</p>
                    {% endif %}
                </ul>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-header text-success">ğŸ“š Favoritos del Cole</div>
            <div class="card-body">
                <ul class="list-group list-group-flush leaderboard-list">
                    {% for book in most_read_books %}
                    <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                        <span>ğŸ“– {{ book.title }}</span>
                        <span class="badge bg-info text-white rounded-pill">{{ book.times_borrowed }} lecturas</span>
                    </li>
                    {% endfor %}
                    {% if not most_read_books %}
                    <p class="text-center text-muted">AÃºn no se han leÃ­do libros.</p>
                    {% endif %}
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}
